# 前端工程化

前端工程化是使用软件工程的技术和方法来进行前端的开发流程、技术、工具、经验等规范化、标准化，其主要目的为了**提高效率和降低成本，即提高开发过程中的开发效率，减少不必要的重复工作时间**，而前端工程本质上是软件工程的一种，因此我们应该从软件工程的角度来研究前端工程。

前端工程化就是为了让前端开发能够“自成体系”，应该包含以下四个方面

- 模块化
- 组件化
- 规范化
- 自动化

## 模块化

简单来说，模块化就是将一个大文件拆分成相互依赖的小文件，再进行统一的拼装和加载。

### JS 的模块化

在 ES6 之前，JavaScript 一直没有模块系统，这对开发大型复杂的前端工程造成了巨大的障碍。对此社区制定了一些模块加载方案，如 CommonJS、AMD 和 CMD 等。

现在 ES6 已经在语言层面上规定了模块系统，完全可以取代现有的 CommonJS 和 AMD 规范，而且使用起来相当简洁，并且有静态加载的特性。

### css 的模块化

虽然 SASS、LESS、Stylus 等预处理器实现了 CSS 的文件拆分，但没有解决选择器的全局污染问题。

按道理，一个模块化的文件应该要隐藏内部作用域，只暴露少量接口给使用者。而按照目前预处理器的方式，导入一个 CSS 模块后，已存在的样式有被覆盖的风险。虽然重写样式是 CSS 的一个优势，但这并不利于多人协作。

为了避免全局选择器的冲突，需要制定 CSS 命名风格：

- BEM 风格
- Bootstrap 风格

此外，社区又创造出 Shadow DOM、CSS in JS 和 CSS Modules 三种解决方案。

- Shadow DOM 是 WebComponents 的标准。它能解决全局污染问题，但目前很多浏览器不兼容，对我们来说还很久远；
- CSS in JS 是彻底抛弃 CSS，使用 JS 或 JSON 来写样式。这种方法很激进，不能利用现有的 CSS 技术，而且处理伪类等问题比较困难；
- CSS Modules 仍然使用 CSS，只是让 JS 来管理依赖。它能够最大化地结合 CSS 生态和 JS 模块化能力，目前来看是最好的解决方案。Vue 的 scoped style 也算是一种。

### 构建工具

什么是构建工具？构建工具可以让我们更好地自动化处理包括（es6 转换，css、js 压缩，less、sass 的转换等），让我们不再需要手动地去重复做这些事情，解放开发人员的双手，更好地聚焦到业务上的开发，构建本质上就是将代码“串”起来，然后压缩并混淆，最终构建出目标代码文件，常见的构建工具有：webpack、rollup、Parcel、grunt、gulp。

### 脚手架

脚手架用于快速生成新项目的目录模板，并集成一系列体系化工具的安装，能够提升前端开发人员的效率，减少 copy 操作。常见的脚手架有 vue-cli 等。

团队可以根据自身需要定制化适合的脚手架工具，需要的常用工具库如下：

- child_process：用于执行 shell 命令
- commander ：用于处理控制台命令
- inquirer： 用于控制台
- semver： 用于版本检测提示
- fs-extra： 用于 fs 操作询问
- execa ：用于执行终端命令
- chalk ：用于五彩斑斓的控制台

## 组件化

从页面拆分下来的每个包含模板(HTML)+样式(CSS)+逻辑(JS)功能完备的结构单元，我们称之为组件。它体现的是一种分治思想：Keep Simple. Everything can be a component。页面上所有的东西都可以看成组件，页面是个大型组件，可以拆成若干个中型组件，然后中型组件还可以再拆，拆成若干个小型组件，小型组件也可以再拆，直到拆成DOM元素为止。DOM元素可以看成是浏览器自身的组件，作为组件的基本单元。

#### 组件化与模块化的区别
* 模块化只是在文件层面上，对代码或资源的拆分；
* 组件化是在设计层面上，对UI（用户界面）的拆分。
* 组件无所谓大小，一个大的页面可以是一个组件，一个小的button也可以是一个组件。

## 规范化

规范化其实是工程化中很重要的一个部分，项目初期规范制定的好坏会直接影响到后期的开发质量。如

- 项目结构规范
- html 规范
- css 规范
- javascript 规范
- 图片规范
- 命名规范
- api 接口规范
- UI 组件规范
- git 分支管理

## 自动化

所谓的自动化就是将很多脏活累活都应该交给工具来完成。需要秉持的一个理念是:**任何简单机械的重复劳动都应该让机器去完成。** 包括自动化构建，自动化部署，自动化测试。

目前大部分SPA只是单纯的静态资源文件，直接打包，然后用nginx做代理就可以完成简单的部署，也可以结合docker和jenkins做自动化部署，持续部署、持续集成。  

前端工程化项目部署涉及到的几个主流工具如下👇

* jenkins: 一个可扩展的自动化服务器，可以用作简单的 CI 服务器，具有自动化构建、测试和部署等功能
* docker: 虚拟环境容器,可以将环境、代码、配置文件等一并打包到这个容器中,最后发布应用
* npm : Node.js 官方提供的包管理工具，主要用来管理项目依赖，发布
* nginx: 可以作为 Web 服务器，也可以作为负载均衡服务器，具备高性能、高并发连接
* pm2: node进程管理工具，可以利用它来简化很多node应用管中繁琐任务

### 参考文献

[前端工程化的理解](https://www.jianshu.com/p/88ed70476adb)
[前端工程化那些事](https://juejin.im/post/5e999cecf265da47cd357a24#heading-17)