<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack4 搭建一个项目 | webpack从入门到精通</title>
    <meta name="description" content="讲解webpack相关知识点">
    
    
    <link rel="preload" href="/webpack-docs/assets/css/0.styles.d386d2e7.css" as="style"><link rel="preload" href="/webpack-docs/assets/js/app.523ca243.js" as="script"><link rel="preload" href="/webpack-docs/assets/js/10.a759a65e.js" as="script"><link rel="prefetch" href="/webpack-docs/assets/js/11.4231ba87.js"><link rel="prefetch" href="/webpack-docs/assets/js/12.0d5f9ecf.js"><link rel="prefetch" href="/webpack-docs/assets/js/2.ffe410d0.js"><link rel="prefetch" href="/webpack-docs/assets/js/3.a9a8433f.js"><link rel="prefetch" href="/webpack-docs/assets/js/4.25c78323.js"><link rel="prefetch" href="/webpack-docs/assets/js/5.3323bb1b.js"><link rel="prefetch" href="/webpack-docs/assets/js/6.d46bfe17.js"><link rel="prefetch" href="/webpack-docs/assets/js/7.eecfade2.js"><link rel="prefetch" href="/webpack-docs/assets/js/8.ef513609.js"><link rel="prefetch" href="/webpack-docs/assets/js/9.da414fd4.js">
    <link rel="stylesheet" href="/webpack-docs/assets/css/0.styles.d386d2e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/webpack-docs/" class="home-link router-link-active"><!----> <span class="site-name">webpack从入门到精通</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/webpack-docs/" class="nav-link">主页</a></div><div class="nav-item"><a href="/webpack-docs/page/" class="nav-link router-link-active">知识库</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Michael-lzg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5b52fd38f265da0f4c6fbd72/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/webpack-docs/" class="nav-link">主页</a></div><div class="nav-item"><a href="/webpack-docs/page/" class="nav-link router-link-active">知识库</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Michael-lzg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5b52fd38f265da0f4c6fbd72/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>webpack专题</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/webpack-docs/page/webpack/基本配置.html" class="sidebar-link">webpack 基本配置</a></li><li><a href="/webpack-docs/page/webpack/知识问答.html" class="sidebar-link">webpack 知识问答</a></li><li><a href="/webpack-docs/page/webpack/对比glup.html" class="sidebar-link">webpack 与 glup</a></li><li><a href="/webpack-docs/page/webpack/搭建项目.html" class="active sidebar-link">webpack4 搭建一个项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/webpack-docs/page/webpack/优化打包.html" class="sidebar-link">webpack 打包优化</a></li><li><a href="/webpack-docs/page/webpack/loader.html" class="sidebar-link">手写一个 loader</a></li><li><a href="/webpack-docs/page/webpack/babel.html" class="sidebar-link">babel 指南</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h3 id="webpack4-搭建一个项目"><a href="#webpack4-搭建一个项目" aria-hidden="true" class="header-anchor">#</a> webpack4 搭建一个项目</h3> <h3 id="_1、新建项目"><a href="#_1、新建项目" aria-hidden="true" class="header-anchor">#</a> 1、新建项目</h3> <p>新建一个空文件夹，用于创建项目，使用 npm init 命令创建一个 package.json 文件。<br>
输入这个命令后，终端会问你一系列诸如项目名称，项目描述，作者等信息，也可以使用 npm init -y 这个命令来一次生成 package.json 文件，这样终端不会询问你问题。</p> <h3 id="_2、安装-webpack"><a href="#_2、安装-webpack" aria-hidden="true" class="header-anchor">#</a> 2、安装 webpack</h3> <p>安装 webapck 时把 webpack-cli 也装上是因为在 webpack4.x 版本后 webpack 模块把一些功能分到了 webpack-cli 模块，所以两者都需要安装，安装方法如下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm install webpack webpack<span class="token operator">-</span>cli <span class="token operator">--</span>global    <span class="token comment">//这是安装全局webpack及webpack-cli模块</span>
npm install webpack webpack<span class="token operator">-</span>cli <span class="token operator">--</span>save<span class="token operator">-</span>dev  <span class="token comment">//这是安装本地项目模块</span>
</code></pre></div><h3 id="_3、新建文件"><a href="#_3、新建文件" aria-hidden="true" class="header-anchor">#</a> 3、新建文件</h3> <p>在根目录件夹中新建两个文件夹，分别为 src 文件夹和 dist 文件夹，接下来再创建三个文件:此时，项目结构如下</p> <ul><li>index.html --放在 dist 文件夹中；</li> <li>hello.js --放在 src 文件夹中；</li> <li>index.js --放在 src 文件夹中；</li></ul> <h4 id="_3-1、-index-html-中写下-html-代码，它的作用是为了引入我们打包后的-js-文件："><a href="#_3-1、-index-html-中写下-html-代码，它的作用是为了引入我们打包后的-js-文件：" aria-hidden="true" class="header-anchor">#</a> 3.1、 index.html 中写下 html 代码，它的作用是为了引入我们打包后的 js 文件：</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Webpack Project<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bundle.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--这是打包之后的js文件，我们暂时命名为bundle.js--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="_3-2、在-hello-js-中导出一个模块："><a href="#_3-2、在-hello-js-中导出一个模块：" aria-hidden="true" class="header-anchor">#</a> 3.2、在 hello.js 中导出一个模块：</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// hello.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> hello <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  hello<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'welcome to China!'</span>
  <span class="token keyword">return</span> hello
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-3、在-index-js-中引入这个模块（hello-js）"><a href="#_3-3、在-index-js-中引入这个模块（hello-js）" aria-hidden="true" class="header-anchor">#</a> 3.3、在 index.js 中引入这个模块（hello.js）:</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.js</span>
<span class="token keyword">const</span> hello <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./hello.js'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>上述操作就相当于我们把 hello.js 模块合并到了 index.js 模块，之后我们打包时就只需把 index.js 模块打包成 bundle.js 即可。</p> <h4 id="_3-4、进行最简单的-webpack-打包"><a href="#_3-4、进行最简单的-webpack-打包" aria-hidden="true" class="header-anchor">#</a> 3.4、进行最简单的 webpack 打包</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 在终端中使用如下命令进行打包：</span>
webpack src<span class="token operator">/</span>index<span class="token punctuation">.</span>js <span class="token operator">--</span>output dist<span class="token operator">/</span>bundle<span class="token punctuation">.</span>js
</code></pre></div><p>上述就相当于把 src 文件夹下的 index.js 文件打包到 dist 文件下的 bundle.js，这时就生成了 bundle.js 供 index.html 文件引用。现在打开 index.html 就可以看到我们的页面了。</p> <h3 id="_4、配置-webpack-config-js"><a href="#_4、配置-webpack-config-js" aria-hidden="true" class="header-anchor">#</a> 4、配置 webpack.config.js</h3> <p>上述打包方式太 low 了，我们可以在当前项目的根目录下新建一个配置文件 webpack.config.js 用来配置打包方式。
webpack.config.js 配置如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span> <span class="token comment">// 处理绝对路径</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/src/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 入口文件</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//打包后的文件存放的地方</span>
    filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span> <span class="token comment">//打包后输出文件的文件名</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有了这个配置文件，我们只需在终端中运行 webpack 命令就可进行打包，这条命令会自动引用 webpack.config.js 文件中的配置选项。</p> <h3 id="_5、构建本地服务器"><a href="#_5、构建本地服务器" aria-hidden="true" class="header-anchor">#</a> 5、构建本地服务器</h3> <p>现在我们是通过打开本地文件来查看页面的，感觉还是有点 low。例如 vue, react 等脚手架都是在本地服务器运行的。所以我们再做进一步优化。</p> <h4 id="_5-1-webpack-dev-server-配置本地服务器"><a href="#_5-1-webpack-dev-server-配置本地服务器" aria-hidden="true" class="header-anchor">#</a> 5.1 webpack-dev-server 配置本地服务器</h4> <p>Webpack 提供了一个可选的本地开发服务器，这个本地服务器基于 node.js 构建，它是一个单独的组件，在 webpack 中进行配置之前需要单独安装它作为项目依赖：npm i webpack-dev-server -D</p> <p>以下是devServer 的一些配置选项:</p> <ul><li>contentBase ：设置服务器所读取文件的目录，当前我们设置为&quot;./dist&quot;</li> <li>port ：设置端口号，如果省略，默认为 8080</li> <li>inline ：设置为 true，当源文件改变时会自动刷新页面</li> <li>historyApiFallback ：设置为 true，所有的跳转将指向 index.html</li></ul> <p>现在我们把这些配置加到 webpack.config.js 文件上，如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/src/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 入口文件</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//打包后的文件存放的地方</span>
    filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span> <span class="token comment">//打包后输出文件的文件名</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    contentBase<span class="token punctuation">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span> <span class="token comment">// 本地服务器所加载文件的目录</span>
    port<span class="token punctuation">:</span> <span class="token string">'8088'</span><span class="token punctuation">,</span> <span class="token comment">// 设置端口号为8088</span>
    inline<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 文件修改后实时刷新</span>
    historyApiFallback<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">//不跳转</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_5-2、package-json-文件中添加启动和打包命令"><a href="#_5-2、package-json-文件中添加启动和打包命令" aria-hidden="true" class="header-anchor">#</a> 5.2、package.json 文件中添加启动和打包命令</h4> <p>package.json 文件修改如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack-project&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;version&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;description&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;main&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;build&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;dev&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;webpack-dev-server --open&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;keywords&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;author&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;license&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;devDependencies&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;^4.23.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack-cli&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;^3.1.2&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;webpack-dev-server&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;^3.1.10&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样我们就可以用以下命令进行本地运行或者打包文件了</p> <ul><li>npm run dev 启动本地服务器，webpack-dev-server 就是启动服务器的命令，--open 是用于启动完服务器后自动打开浏览器。</li> <li>npm run build 执行打包命令</li></ul> <p>此时，我们只要输入 npm run dev 就可以在http://localhost:8088/中查看页面了。</p> <h3 id="_6、配置常用-loader"><a href="#_6、配置常用-loader" aria-hidden="true" class="header-anchor">#</a> 6、配置常用 loader</h3> <p>loader 可以让 webpack 能够去处理那些非 JavaScript 文件（webpack 自身只理解 JavaScript）。loader 可以将所有类型的文件转换为 webpack 能够处理的有效模块，然后你就可以利用 webpack 的打包能力，对它们进行处理。</p> <p>Loaders 的配置包括以下几方面：</p> <ul><li>test：一个用以匹配 loaders 所处理文件的拓展名的正则表达式（必须）</li> <li>loader：loader 的名称（必须）</li> <li>include/exclude：手动添加必须处理的文件（文件夹）或屏蔽不需要处理的文件（文件夹）（可选）；</li> <li>options：为 loaders 提供额外的设置选项（可选）</li></ul> <h4 id="配置-css-loader-和-sass-loader"><a href="#配置-css-loader-和-sass-loader" aria-hidden="true" class="header-anchor">#</a> 配置 css-loader 和 sass-loader</h4> <p>如果我们要加载一个 css 文件，需要安装配置 style-loader 和 css-loader。<br>
如果我们要使用 sass，就要配置 sass-loader 和 node-sass。</p> <ul><li>css-loader：加载.css 文件</li> <li>style-loader：使用 style 标签将 css-loader 内部样式注入到我们的 HTML 页面</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/src/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 入口文件</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//打包后的文件存放的地方</span>
    filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span> <span class="token comment">//打包后输出文件的文件名</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    contentBase<span class="token punctuation">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span> <span class="token comment">// 本地服务器所加载文件的目录</span>
    port<span class="token punctuation">:</span> <span class="token string">'8088'</span><span class="token punctuation">,</span> <span class="token comment">// 设置端口号为8088</span>
    inline<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 文件修改后实时刷新</span>
    historyApiFallback<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">//不跳转</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> <span class="token comment">// 正则匹配以.css结尾的文件</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(scss|sass)$/</span><span class="token punctuation">,</span> <span class="token comment">// 正则匹配以.scss和.sass结尾的文件</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="配置-babel-loader"><a href="#配置-babel-loader" aria-hidden="true" class="header-anchor">#</a> 配置 Babel-loader</h4> <p>Babel 其实是一个编译 JavaScript 的平台，它可以编译代码帮你达到以下目的：</p> <ul><li>让你能使用最新的 JavaScript 代码（ES6，ES7...）；</li> <li>让你能使用基于 JavaScript 进行了拓展的语言，比如 React 的 JSX；</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
      loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
      include<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="处理图片"><a href="#处理图片" aria-hidden="true" class="header-anchor">#</a> 处理图片</h4> <p>处理图片资源时，我们常用的两种 loader 是 file-loader 或者 url-loader。
当使用 url-loader 加载图片，图片小于上限值，则将图片转 base64 字符串，否则使用 file-loader 加载图片。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span><span class="token punctuation">,</span>
      loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
      options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        limit<span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> utils<span class="token punctuation">.</span><span class="token function">assetsPath</span><span class="token punctuation">(</span><span class="token string">'img/[name].[hash:7].[ext]'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7、配置常用插件"><a href="#_7、配置常用插件" aria-hidden="true" class="header-anchor">#</a> 7、配置常用插件</h3> <p>loader 被用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。插件的范围包括，从打包优化和压缩，一直到重新定义环境中的变量。插件接口功能极其强大，可以用来处理各种各样的任务。</p> <h4 id="_7-1、自动生成-html-文件-htmlwebpackplugin"><a href="#_7-1、自动生成-html-文件-htmlwebpackplugin" aria-hidden="true" class="header-anchor">#</a> 7.1、自动生成 html 文件(HtmlWebpackPlugin)</h4> <p>现在我们都是使用一开始建好的 index.html 文件，然后手动引入 bundle.js，如果以后我们引入不止一个 js 文件，那就得更改 index.html 中的 js 文件名，所以能不能自动生成 index.html 且自动引用打包后的 js 呢？<br>
HtmlWebpackPlugin 插件就是用来解决这个问题的：</p> <ol><li>安装插件 npm i html-webpack-plugin -D</li> <li>把 dist 文件夹清空</li> <li>在根目录新建 index.html,内容和原来的 html 一致，只是不引入 js 文件。</li> <li>webpack.config.js 中我们引入了 HtmlWebpackPlugin 插件</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
    template<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      removeComments<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><p>此时我们使用 npm run build 进行打包，你会发现，dist 文件夹和 html 文件都会自动生成。</p> <h4 id="_7-2、清理-dist-文件夹-cleanwebpackplugin"><a href="#_7-2、清理-dist-文件夹-cleanwebpackplugin" aria-hidden="true" class="header-anchor">#</a> 7.2、清理/dist 文件夹(CleanWebpackPlugin)</h4> <p>在每次构建前清理/dist 文件夹，生产最新的打包文件，这时候就用到 CleanWebpackPlugin 插件了。</p> <ol><li>安装 npm i clean-webpack-plugin -D</li> <li>配置 webpack.config.js</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
    template<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      removeComments<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'dist'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><h4 id="_7-3、热更新-hotmodulereplacementplugin"><a href="#_7-3、热更新-hotmodulereplacementplugin" aria-hidden="true" class="header-anchor">#</a> 7.3、热更新(HotModuleReplacementPlugin)</h4> <p>我们要在修改代码后自动更新页面，这就需要 HotModuleReplacementPlugin（HMR）插件</p> <ol><li>devServer 配置项中添加 hot: true 参数。</li> <li>因为 HotModuleReplacementPlugin 是 webpack 模块自带的，所以引入 webpack 后，在 plugins 配置项中直接使用即可。</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
    template<span class="token punctuation">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      removeComments<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      removeAttributeQuotes<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'dist'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><h4 id="_7-4、增加-css-前缀"><a href="#_7-4、增加-css-前缀" aria-hidden="true" class="header-anchor">#</a> 7.4、增加 css 前缀</h4> <p>平时我们写 css 时，一些属性需要手动加上前缀，比如-webkit-border-radius: 10px;，在 webpack 中我们可以让他自动加上</p> <ol><li>安装 npm i postcss-loader autoprefixer -D</li> <li>在项目根目录下新建 postcss.config.js 文件</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span> <span class="token comment">// 引用autoprefixer模块</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token operator">...</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> <span class="token comment">// 正则匹配以.css结尾的文件</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> <span class="token string">'style-loader'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 这里采用的是对象配置loader的写法</span>
          <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> <span class="token string">'css-loader'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> <span class="token string">'postcss-loader'</span> <span class="token punctuation">}</span> <span class="token comment">// 使用postcss-loader</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
       <span class="token operator">...</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
   <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_7-5、css-分离-extracttextplugin"><a href="#_7-5、css-分离-extracttextplugin" aria-hidden="true" class="header-anchor">#</a> 7.5、css 分离 ExtractTextPlugin</h4> <p>将 css 成生文件，而非内联。该插件的主要是为了抽离 css 样式,防止将样式打包在 js 中引起页面样式加载错乱的现象。</p> <ol><li>安装 npm i extract-text-webpack-plugin@next -D</li> <li>在 webpack.common.js 文件中引入并使用该插件：</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'extract-text-webpack-plugin'</span><span class="token punctuation">)</span> <span class="token comment">//引入分离插件</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> <span class="token comment">// 正则匹配以.css结尾的文件</span>
        use<span class="token punctuation">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token comment">// 相当于回滚，经postcss-loader和css-loader处理过的css最终再经过style-loader处理</span>
          fallback<span class="token punctuation">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
          use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token string">'css/index.css'</span><span class="token punctuation">)</span> <span class="token comment">// 将css分离到/dist文件夹下的css文件夹中的index.css</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此时运行 npm run build 后会发现/dist 文件夹内多出了/css 文件夹及 index.css 文件。</p> <h4 id="_7-6、消除冗余-css"><a href="#_7-6、消除冗余-css" aria-hidden="true" class="header-anchor">#</a> 7.6、消除冗余 css</h4> <p>有时候我们 css 写得多了，可能会不自觉的写重复了一些样式，这就造成了多余的代码，以下方法可以优化</p> <ol><li>安装 npm i purifycss-webpack purify-css glob -D</li> <li>引入 clean-webpack-plugin 及 glob 插件并使用</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> PurifyCssWebpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'purifycss-webpack'</span><span class="token punctuation">)</span> <span class="token comment">// 引入PurifyCssWebpack插件</span>
<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob'</span><span class="token punctuation">)</span> <span class="token comment">// 引入glob模块,用于扫描全部html文件中所引用的css</span>

plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">PurifyCssWebpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    paths<span class="token punctuation">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/*.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 同步扫描所有html文件中所引用的css</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><h4 id="至此，一些常用的配置以及弄好了，现在就开始愉快地写代码了。"><a href="#至此，一些常用的配置以及弄好了，现在就开始愉快地写代码了。" aria-hidden="true" class="header-anchor">#</a> 至此，一些常用的配置以及弄好了，现在就开始愉快地写代码了。</h4></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/webpack-docs/assets/js/app.523ca243.js" defer></script><script src="/webpack-docs/assets/js/10.a759a65e.js" defer></script>
  </body>
</html>
