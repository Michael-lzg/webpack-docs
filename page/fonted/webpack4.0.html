<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 4.0 | webpack从入门到精通</title>
    <meta name="description" content="讲解webpack相关知识点">
    
    
    <link rel="preload" href="/webpack-docs/assets/css/0.styles.d386d2e7.css" as="style"><link rel="preload" href="/webpack-docs/assets/js/app.d193fe94.js" as="script"><link rel="preload" href="/webpack-docs/assets/js/18.7914fb5e.js" as="script"><link rel="prefetch" href="/webpack-docs/assets/js/10.65749ef8.js"><link rel="prefetch" href="/webpack-docs/assets/js/11.49efa7cc.js"><link rel="prefetch" href="/webpack-docs/assets/js/12.1b278652.js"><link rel="prefetch" href="/webpack-docs/assets/js/13.b81fa354.js"><link rel="prefetch" href="/webpack-docs/assets/js/14.c8d9efba.js"><link rel="prefetch" href="/webpack-docs/assets/js/15.107aaab4.js"><link rel="prefetch" href="/webpack-docs/assets/js/16.db6d3797.js"><link rel="prefetch" href="/webpack-docs/assets/js/17.f8c3a1c5.js"><link rel="prefetch" href="/webpack-docs/assets/js/19.c0c37cca.js"><link rel="prefetch" href="/webpack-docs/assets/js/2.0782c440.js"><link rel="prefetch" href="/webpack-docs/assets/js/20.bb008680.js"><link rel="prefetch" href="/webpack-docs/assets/js/3.b3d60b1a.js"><link rel="prefetch" href="/webpack-docs/assets/js/4.c1dab2c8.js"><link rel="prefetch" href="/webpack-docs/assets/js/5.90536a28.js"><link rel="prefetch" href="/webpack-docs/assets/js/6.73f2010d.js"><link rel="prefetch" href="/webpack-docs/assets/js/7.be21827e.js"><link rel="prefetch" href="/webpack-docs/assets/js/8.eb6f9133.js"><link rel="prefetch" href="/webpack-docs/assets/js/9.13f17710.js">
    <link rel="stylesheet" href="/webpack-docs/assets/css/0.styles.d386d2e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/webpack-docs/" class="home-link router-link-active"><!----> <span class="site-name">webpack从入门到精通</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/webpack-docs/" class="nav-link">主页</a></div><div class="nav-item"><a href="/webpack-docs/page/" class="nav-link router-link-active">知识库</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Michael-lzg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5b52fd38f265da0f4c6fbd72/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/webpack-docs/" class="nav-link">主页</a></div><div class="nav-item"><a href="/webpack-docs/page/" class="nav-link router-link-active">知识库</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/Michael-lzg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5b52fd38f265da0f4c6fbd72/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>webpack前世今生</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/webpack-docs/page/fonted/前端模块化.html" class="sidebar-link">前端模块化</a></li><li><a href="/webpack-docs/page/fonted/glup.html" class="sidebar-link">webpack 与 glup</a></li><li><a href="/webpack-docs/page/fonted/webpack4.0.html" class="active sidebar-link">webpack 4.0</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>webpack基础篇</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/webpack-docs/page/base/entry.html" class="sidebar-link">entry和output</a></li><li><a href="/webpack-docs/page/base/loader.html" class="sidebar-link">Loader</a></li><li><a href="/webpack-docs/page/base/plugin.html" class="sidebar-link">Plugin</a></li><li><a href="/webpack-docs/page/base/webpack-dev-derver.html" class="sidebar-link">webpack-dev-derver</a></li><li><a href="/webpack-docs/page/base/sourcemap.html" class="sidebar-link">sourceMap</a></li><li><a href="/webpack-docs/page/base/optimization.html" class="sidebar-link">optimization</a></li><li><a href="/webpack-docs/page/base/babel.html" class="sidebar-link">babel 指南</a></li><li><a href="/webpack-docs/page/base/hash.html" class="sidebar-link">文件 hash</a></li><li><a href="/webpack-docs/page/base/知识问答.html" class="sidebar-link">webpack 知识问答</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>webpack深入篇</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/webpack-docs/page/advanced/demo.html" class="sidebar-link">搭建一个项目</a></li><li><a href="/webpack-docs/page/advanced/优化打包.html" class="sidebar-link">打包优化</a></li><li><a href="/webpack-docs/page/advanced/webpack-chain.html" class="sidebar-link">webpack-chain</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="webpack-4-0"><a href="#webpack-4-0" aria-hidden="true" class="header-anchor">#</a> webpack 4.0</h1> <p>2018 年 8 月 25 号 webpack4 正式发布。再次之后只要使用 npm install webpack 命令，默认安装的就是版本 4。webpack4 号称零配置开箱即用，那么来看看 webpack4.x 和 3.x 比较大的区别。官方宣传能够提升构建速度 60%-98%，这是不是真的呢？</p> <h3 id="构建速度"><a href="#构建速度" aria-hidden="true" class="header-anchor">#</a> 构建速度</h3> <p>Webpack4.0 的构建速度远远快于 Webpack3.0，官方也说升级之后，升级版本之后，构建时间可以降低 60% - 98% 左右。</p> <ul><li>v8 引擎带来的优化（for of 替代 forEach、Map 和 Set 替代 Object、includes 替代 indexOf）</li> <li>默认使用更快的 md4 hash 算法</li> <li>webpack AST 可以直接从 loader 传递给 AST，减少解析时间</li> <li>使用字符串方法替代正则表达式</li></ul> <h3 id="版本问题"><a href="#版本问题" aria-hidden="true" class="header-anchor">#</a> 版本问题</h3> <ol><li>webpack依赖包 webpack webpack-cli</li> <li>Node 环境的升级:不在支持 node 4.0 的版本，最低支持 6.11.5。</li> <li>各种配件升级，各种 loader 升级。如果在编译过程中报 can not find xxx 的错误，说明 xxx 对应的 loader 可能需要升级了，因为 webpack4 去掉了 this.options 的支持</li></ol> <h3 id="mode-配置"><a href="#mode-配置" aria-hidden="true" class="header-anchor">#</a> mode 配置</h3> <p>webpack4 增加了一个 mode 配置，只有两种值 development | production。对不同的环境他会启用不同的配置。</p> <ul><li>默认生产环境开起了很多代码优化（minify, splite）</li> <li>开发时开启注视和验证，并加上了 evel devtool</li> <li>生产环境不支持 watching，开发环境优化了打包的速度</li> <li>生产环境开启模块串联（原 ModulecondatenationPlugin）</li> <li>自动设置 process.env.NODE_EVN 到不同环境，也就是不使用 DefinePlugin 了</li> <li>如果 mode 设置 none，所有默认设置都去掉了。</li></ul> <h3 id="commonschunkplugin"><a href="#commonschunkplugin" aria-hidden="true" class="header-anchor">#</a> CommonsChunkPlugin</h3> <p>听说 webpack 升级到 4，最大的感触就是去点了这个 CommonsChunkPlugin,因为官方发的 change log 最大的篇幅就是介绍的他
CommonsChunkPlugin 删除之后，改成使用 optimization.splitChunks 进行模块划分</p> <div class="language-js extra-class"><pre class="language-js"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
    cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      vendor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">&quot;vendor&quot;</span><span class="token punctuation">,</span>
        test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
        priority<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        chunks<span class="token punctuation">:</span> <span class="token string">&quot;initial&quot;</span> <span class="token comment">// 只打包初始时依赖的第三方</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="uglifyjsplugin"><a href="#uglifyjsplugin" aria-hidden="true" class="header-anchor">#</a> UglifyJsPlugin</h3> <p>webpack4 不需要使用这个 plugin 了，只需要使用 optimization.minimize 为 true 就行，production mode 下面自动为 true。</p> <p>optimization.minimizer 可以配置你自己的压缩程序</p> <div class="language-js extra-class"><pre class="language-js"><code>optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      parallel<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">// 开启几个进程来处理压缩</span>
      cache<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否缓存</span>
      sourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 压缩css</span>
    <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="mini-css-extract-plugin"><a href="#mini-css-extract-plugin" aria-hidden="true" class="header-anchor">#</a> mini-css-extract-plugin</h3> <p>webpack4 删除原 extract-text-webpack-plugin 配置，增加 mini-css-extract-plugin 配置</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.(le|c)ss$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          loader<span class="token punctuation">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            publicPath<span class="token punctuation">:</span> <span class="token string">'../'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
        <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
        <span class="token string">'less-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'css/[name].[contenthash:8].css'</span><span class="token punctuation">,</span>
    chunkFilename<span class="token punctuation">:</span> <span class="token string">'css/[id].[contenthash:8].css'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="vue-loader。"><a href="#vue-loader。" aria-hidden="true" class="header-anchor">#</a> vue-loader。</h3> <p>vue-loader 要配合一个 webpack 插件才能正确使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> VueLoaderPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-loader'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">,</span>
        loader<span class="token punctuation">:</span> <span class="token string">'vue-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="支持-es6-的方式导入-json-文件"><a href="#支持-es6-的方式导入-json-文件" aria-hidden="true" class="header-anchor">#</a> 支持 es6 的方式导入 JSON 文件</h3> <p>原生支持处理JSON文件格式，不需要json-loader，并且可以过滤无用的代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> jsonData <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> jsonData <span class="token keyword">from</span> <span class="token string">'./data.json'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> first <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./data.json'</span> <span class="token comment">// 打包时只会把first相关的打进去</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/webpack-docs/page/fonted/glup.html" class="prev">
          webpack 与 glup
        </a></span> <span class="next"><a href="/webpack-docs/page/base/entry.html">
          entry和output
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/webpack-docs/assets/js/app.d193fe94.js" defer></script><script src="/webpack-docs/assets/js/18.7914fb5e.js" defer></script>
  </body>
</html>
